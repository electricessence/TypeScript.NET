define(["require","exports","../Compare","./Array/Utility","../Types","../Integer","./Enumeration/EnumeratorBase","../Exceptions/NotImplementedException","../Exceptions/InvalidOperationException","../Exceptions/ArgumentOutOfRangeException","./CollectionBase","../../extends"],function(e,t,r,i,a,n,o,s,u,c,p,_){"use strict";function y(e,t){if(e<0)throw new c.ArgumentOutOfRangeException(t,e,"Must be greater than zero");return!0}function l(e,t){return n.Integer.assert(e,t),y(e,t)}var f=_["default"],d=void 0,h=4,v=32,m=100,E=h,g=Object.freeze([]),z=function(e){function t(t,n){void 0===n&&(n=r.areEqual);var o=e.call(this,d,n)||this,s=o;if(s._head=0,s._tail=0,s._size=0,t)if(a.Type.isNumber(t)){var u=t;l(u,"capacity"),s._array=u?i.initialize(u):g}else{var c=t;s._array=i.initialize(a.Type.isArrayLike(c)?c.length:E),s._importEntries(c)}else s._array=g;return s._capacity=s._array.length,o}return f(t,e),t.prototype.getCount=function(){return this._size},t.prototype._addInternal=function(e){var t=this,r=t._size,i=t._capacity;if(r==i){var a=i*m;a<i+h&&(a=i+h),t.setCapacity(a),i=t._capacity}var n=t._tail;return t._array[n]=e,t._tail=(n+1)%i,t._size=r+1,!0},t.prototype._removeInternal=function(e,t){throw new s.NotImplementedException("ICollection<T>.remove is not implemented in Queue<T> since it would require destroying the underlying array to remove the item.")},t.prototype._clearInternal=function(){var e=this,t=e._array,r=e._head,a=e._tail,n=e._size;return r<a?i.clear(t,r,a):(i.clear(t,r),i.clear(t,0,a)),e._head=0,e._tail=0,e._size=0,e.trimExcess(),n},t.prototype._onDispose=function(){e.prototype._onDispose.call(this);var t=this;t._array!=g&&(t._array.length=t._capacity=0,t._array=g)},t.prototype.dump=function(e){void 0===e&&(e=1/0);var t=this,r=[];if(isFinite(e)){if(n.Integer.assertZeroOrGreater(e),0!==e)for(;e--&&t._tryDequeueInternal(function(e){r.push(e)}););}else for(;t._tryDequeueInternal(function(e){r.push(e)}););return t.trimExcess(),t._signalModification(),r},t.prototype.forEach=function(t){return e.prototype.forEach.call(this,t,!0)},t.prototype.setCapacity=function(e){var t=this;l(e,"capacity");var r=t._array,a=t._capacity;if(e>a&&t.throwIfDisposed(),e!=a){var n=t._head,o=t._tail,s=t._size;if(r!=g&&e>a&&n<o)return r.length=t._capacity=e,void t._version++;var u=i.initialize(e);s>0&&(n<o?i.copyTo(r,u,n,0,s):(i.copyTo(r,u,n,0,a-n),i.copyTo(r,u,0,a-n,o))),t._array=u,t._capacity=e,t._head=0,t._tail=s==e?0:s,t._signalModification(!0)}},t.prototype.enqueue=function(e){this.add(e)},t.prototype._tryDequeueInternal=function(e){var t=this;if(!t._size)return!1;var r=t._array,i=t._head,a=t._array[i];return r[i]=null,t._head=(i+1)%t._capacity,t._size--,t._incrementModified(),e(a),!0},t.prototype.dequeue=function(e){void 0===e&&(e=!1);var t=this;t.assertModifiable();var r=d;if(!this.tryDequeue(function(e){r=e})&&e)throw new u.InvalidOperationException("Cannot dequeue an empty queue.");return r},t.prototype.tryDequeue=function(e){var t=this;return!!t._size&&(t.assertModifiable(),!!this._tryDequeueInternal(e)&&(t._size<t._capacity/2&&t.trimExcess(v),t._signalModification(),!0))},t.prototype._getElement=function(e){l(e,"index");var t=this;return t._array[(t._head+e)%t._capacity]},t.prototype.peek=function(e){if(void 0===e&&(e=!1),0==this._size){if(e)throw new u.InvalidOperationException("Cannot call peek on an empty queue.");return d}return this._array[this._head]},t.prototype.trimExcess=function(e){var t=this,r=t._size;r<Math.floor(.9*t._capacity)&&(!e&&0!==e||isNaN(e)||e<r)&&t.setCapacity(r)},t.prototype.getEnumerator=function(){var e=this;e.throwIfDisposed();var t,r,i;return new o.EnumeratorBase(function(){r=e._version,i=e._size,t=0},function(a){return e.throwIfDisposed(),e.assertVersion(r),t==i?a.yieldBreak():a.yieldReturn(e._getElement(t++))})},t}(p.CollectionBase);t.Queue=z,Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=z});
//# sourceMappingURL=Queue.js.map