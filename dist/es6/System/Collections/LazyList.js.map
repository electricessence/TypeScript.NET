{"version":3,"sources":["System/Collections/LazyList.ts"],"names":[],"mappings":"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","file":"LazyList.js","sourcesContent":["/*!\r\n * @author electricessence / https://github.com/electricessence/\r\n * Origin: http://www.fallingcanbedeadly.com/\r\n * Licensing: MIT\r\n */\r\n\r\nimport {IEnumerator} from \"./Enumeration/IEnumerator\";\r\nimport {ReadOnlyCollectionBase} from \"./ReadOnlyCollectionBase\";\r\nimport {IEnumerable} from \"./Enumeration/IEnumerable\";\r\nimport {Action} from \"../FunctionTypes\";\r\nimport {IReadOnlyList} from \"./IList\";\r\nimport {ArgumentOutOfRangeException} from \"../Exceptions/ArgumentOutOfRangeException\";\r\nimport {EnumeratorBase} from \"./Enumeration/EnumeratorBase\";\r\nimport __extendsImport from \"../../extends\";\r\nimport {Integer} from \"../Integer\";\r\n// noinspection JSUnusedLocalSymbols\r\nconst __extends = __extendsImport;\r\n\r\nexport class LazyList<T> extends ReadOnlyCollectionBase<T> implements IReadOnlyList<T>\r\n{\r\n\r\n\tprivate _enumerator:IEnumerator<T>|null;\r\n\tprivate _cached:T[]|null;\r\n\r\n\tconstructor(source:IEnumerable<T>)\r\n\t{\r\n\t\tsuper();\r\n\t\tthis._enumerator = source.getEnumerator();\r\n\t\tthis._cached = [];\r\n\t}\r\n\r\n\tprotected _onDispose():void\r\n\t{\r\n\t\tsuper._onDispose();\r\n\t\tconst e = this._enumerator;\r\n\t\tthis._enumerator = null;\r\n\t\tif(e) e.dispose();\r\n\r\n\t\tconst c = this._cached;\r\n\t\tthis._cached = null;\r\n\t\tif(c) c.length = 0;\r\n\t}\r\n\r\n\tprotected _getCount():number\r\n\t{\r\n\t\tthis.finish();\r\n\t\tconst c = this._cached;\r\n\t\treturn c ? c.length : 0;\r\n\t}\r\n\r\n\tprotected _getEnumerator():IEnumerator<T>\r\n\t{\r\n\t\tlet current:number;\r\n\t\treturn new EnumeratorBase<T>(\r\n\t\t\t()=>{\r\n\t\t\t\tcurrent = 0;\r\n\t\t\t},\r\n\t\t\tyielder =>\r\n\t\t\t{\r\n\t\t\t\tthis.throwIfDisposed();\r\n\t\t\t\tconst c = this._cached!;\r\n\t\t\t\treturn (current<c.length || this.getNext())\r\n\t\t\t\t\t? yielder.yieldReturn(c[current++])\r\n\t\t\t\t\t: yielder.yieldBreak();\r\n\t\t\t});\r\n\t}\r\n\r\n\tget(index:number):T\r\n\t{\r\n\t\tthis.throwIfDisposed();\r\n\t\tInteger.assertZeroOrGreater(index);\r\n\r\n\t\tconst c = this._cached!;\r\n\t\twhile(c.length<=index && this.getNext())\r\n\t\t{}\r\n\r\n\t\tif(index<c.length)\r\n\t\t\treturn c[index];\r\n\r\n\t\tthrow new ArgumentOutOfRangeException(\"index\", \"Greater than total count.\");\r\n\t}\r\n\r\n\tindexOf(item:T):number\r\n\t{\r\n\t\tthis.throwIfDisposed();\r\n\t\tconst c = this._cached!;\r\n\t\tlet result = c.indexOf(item);\r\n\t\twhile(result== -1 && this.getNext(value =>\r\n\t\t{\r\n\t\t\tif(value==item)\r\n\t\t\t\tresult = c.length - 1;\r\n\t\t}))\r\n\t\t{}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tcontains(item:T):boolean\r\n\t{\r\n\t\treturn this.indexOf(item)!=-1;\r\n\t}\r\n\r\n\tprivate getNext(out?:Action<T>):boolean\r\n\t{\r\n\t\tconst e = this._enumerator;\r\n\t\tif(!e) return false;\r\n\t\tif(e.moveNext())\r\n\t\t{\r\n\t\t\tconst value = e.current!;\r\n\t\t\tthis._cached!.push(value);\r\n\t\t\tif(out) out(value);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\te.dispose();\r\n\t\t\tthis._enumerator = <any>null;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\r\n\tprivate finish():void\r\n\t{\r\n\t\twhile(this.getNext())\r\n\t\t{}\r\n\t}\r\n\r\n\r\n}"]}