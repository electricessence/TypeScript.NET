{"version":3,"sources":["System/Uri/Uri.ts"],"names":[],"mappings":"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","file":"Uri.js","sourcesContent":["/*!\r\n * @author electricessence / https://github.com/electricessence/\r\n * Licensing: MIT https://github.com/electricessence/TypeScript.NET/blob/master/LICENSE.md\r\n * Based on: https://en.wikipedia.org/wiki/Uniform_Resource_Identifier\r\n */\r\n\r\nimport {Type} from \"../Types\";\r\nimport {UriComponent} from \"./UriComponent\";\r\nimport {Scheme} from \"./Scheme\";\r\nimport {SchemeValue} from \"./SchemeValue\";\r\nimport {QueryParam} from \"./QueryParam\";\r\nimport {encode, parseToMap, Separator} from \"./QueryParams\";\r\nimport {trim} from \"../Text/Utility\";\r\nimport {Exception} from \"../Exception\";\r\nimport {ArgumentException} from \"../Exceptions/ArgumentException\";\r\nimport {ArgumentOutOfRangeException} from \"../Exceptions/ArgumentOutOfRangeException\";\r\nimport {IUri} from \"./IUri\";\r\nimport {IMap} from \"../../IMap\";\r\nimport {Primitive} from \"../Primitive\";\r\nimport {StringKeyValuePair} from \"../KeyValuePair\";\r\nimport {IEquatable} from \"../IEquatable\";\r\nimport {Action} from \"../FunctionTypes\";\r\n\r\nconst VOID0:undefined = void 0;\r\n\r\n/**\r\n * Provides an read-only model representation of a uniform resource identifier (URI) and easy access to the parts of the URI.\r\n *\r\n * The read-only model (frozen) is easier for debugging than exposing accessors for each property.\r\n * ICloneable&lt;Uri&gt; is not used to prevent unnecessary copying of values that won't change.\r\n */\r\nexport class Uri implements IUri, IEquatable<IUri>\r\n{\r\n\r\n\treadonly scheme:SchemeValue.Any | null;\r\n\treadonly userInfo:string | null;\r\n\treadonly host:string | null;\r\n\treadonly port:number | null;\r\n\treadonly path:string | null;\r\n\treadonly query:string | null;\r\n\treadonly fragment:string | null;\r\n\r\n\treadonly queryParams:IMap<Primitive|Primitive[]>;//Readonly<IMap<Primitive|Primitive[]>>;\r\n\r\n\t/**\r\n\t * @param scheme The user name, password, or other user-specific information associated with the specified URI.\r\n\t * @param userInfo The host component of this instance.\r\n\t * @param host The port number of this URI.\r\n\t * @param port The absolute path of the URI.\r\n\t * @param path The absolute path of the URI.\r\n\t * @param query Any query information included in the specified URI.\r\n\t * @param fragment The escaped URI fragment.\r\n\t */\r\n\tconstructor(\r\n\t\tscheme:SchemeValue.Any|null,\r\n\t\tuserInfo:string|null,\r\n\t\thost:string|null,\r\n\t\tport:number|null,\r\n\t\tpath:string|null,\r\n\t\tquery?:QueryParam.Convertible,\r\n\t\tfragment?:string)\r\n\t{\r\n\t\tconst _ = this;\r\n\t\tthis.scheme = getScheme(scheme) || null;\r\n\t\tthis.userInfo = userInfo || null;\r\n\t\tthis.host = host || null;\r\n\r\n\t\tthis.port = getPort(port);\r\n\r\n\t\tthis.authority = _.getAuthority() || null;\r\n\r\n\t\tthis.path = path || null;\r\n\r\n\r\n\t\tif(!Type.isString(query))\r\n\t\t\tquery = encode(<UriComponent.Map|StringKeyValuePair<Primitive>[]>query);\r\n\r\n\t\tthis.query = formatQuery(<string>query) || null;\r\n\t\tObject.freeze(this.queryParams\r\n\t\t\t= _.query\r\n\t\t\t? parseToMap(_.query)\r\n\t\t\t: {});\r\n\r\n\t\tthis.pathAndQuery = _.getPathAndQuery() || null;\r\n\r\n\t\tthis.fragment = formatFragment(fragment) || null;\r\n\r\n\t\t// This should validate the uri...\r\n\t\tthis.absoluteUri = _.getAbsoluteUri();\r\n\r\n\t\tthis.baseUri = _.absoluteUri.replace(/[?#].*/, '');\r\n\r\n\t\t// Intended to be read-only.  Call .toMap() to get a writable copy.\r\n\t\tObject.freeze(this);\r\n\t}\r\n\r\n\t/**\r\n\t *  Compares the values of another IUri via toString comparison.\r\n\t * @param other\r\n\t * @returns {boolean}\r\n\t */\r\n\tequals(other:IUri):boolean\r\n\t{\r\n\t\treturn this===other || this.absoluteUri==Uri.toString(other);\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Parses or clones values from existing Uri values.\r\n\t * @param uri\r\n\t * @param defaults\r\n\t * @returns {Uri}\r\n\t */\r\n\tstatic from(uri:string|IUri|null|undefined, defaults?:IUri):Uri\r\n\t{\r\n\t\tconst u = Type.isString(uri)\r\n\t\t\t? Uri.parse(<string>uri) // Parsing a string should throw errors.  Null or undefined simply means empty.\r\n\t\t\t: <IUri>uri;\r\n\r\n\t\treturn new Uri(\r\n\t\t\tu && u.scheme || defaults && <any>defaults.scheme,\r\n\t\t\tu && u.userInfo || defaults && <any>defaults.userInfo,\r\n\t\t\tu && u.host || defaults && <any>defaults.host,\r\n\t\t\tu && Type.isNumber(u.port,true) ? u.port : defaults && <any>defaults.port,\r\n\t\t\tu && u.path || defaults && <any>defaults.path,\r\n\t\t\tu && u.query || defaults && <any>defaults.query,\r\n\t\t\tu && u.fragment || defaults && <any>defaults.fragment\r\n\t\t);\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Parses a URL into it's components.\r\n\t * @param url The url to parse.\r\n\t * @returns {IUri} Will throw an exception if not able to parse.\r\n\t */\r\n\tstatic parse(url:string):IUri\r\n\r\n\tstatic parse(url:string, throwIfInvalid:true):IUri\r\n\r\n\t/**\r\n\t * Parses a URL into it's components.\r\n\t * @param url The url to parse.\r\n\t * @param throwIfInvalid Defaults to true.\r\n\t * @returns {IUri} Returns a map of the values or *null* if invalid and *throwIfInvalid* is <b>false</b>.\r\n\t */\r\n\tstatic parse(url:string, throwIfInvalid:boolean):IUri|null\r\n\tstatic parse(url:string, throwIfInvalid:boolean = true):IUri|null\r\n\t{\r\n\t\tlet result:IUri|null = null;\r\n\t\tconst ex = tryParse(url, (out) => {result = out;});\r\n\t\tif(throwIfInvalid && ex) throw ex;\r\n\t\treturn result;\r\n\t}\r\n\r\n\t/**\r\n\t * Parses a URL into it's components.\r\n\t * @param url The url to parse.\r\n\t * @param out A delegate to capture the value.\r\n\t * @returns {boolean} True if valid.  False if invalid.\r\n\t */\r\n\tstatic tryParse(url:string, out:(result:IUri)=>void):boolean\r\n\t{\r\n\t\treturn !tryParse(url, out); // return type is Exception.\r\n\t}\r\n\r\n\tstatic copyOf(map:IUri):IUri\r\n\t{\r\n\t\treturn copyUri(map);\r\n\t}\r\n\r\n\tcopyTo(map:IUri):IUri\r\n\t{\r\n\t\treturn copyUri(this, map);\r\n\t}\r\n\r\n\tupdateQuery(query:QueryParam.Convertible):Uri\r\n\t{\r\n\t\tconst map = this.toMap();\r\n\t\tmap.query = <any>query;\r\n\t\treturn Uri.from(map);\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Is provided for sub classes to override this value.\r\n\t */\r\n\tprotected getAbsoluteUri():string\r\n\t{\r\n\t\treturn uriToString(this);\r\n\t}\r\n\r\n\t/**\r\n\t * Is provided for sub classes to override this value.\r\n\t */\r\n\tprotected getAuthority():string\r\n\t{\r\n\t\treturn getAuthority(this);\r\n\t}\r\n\r\n\t/**\r\n\t * Is provided for sub classes to override this value.\r\n\t */\r\n\tprotected getPathAndQuery():string\r\n\t{\r\n\t\treturn getPathAndQuery(this);\r\n\t}\r\n\r\n\t/**\r\n\t * The absolute URI.\r\n\t */\r\n\tabsoluteUri:string;\r\n\r\n\t/**\r\n\t * Gets the Domain Name System (DNS) host name or IP address and the port number for a server.\r\n\t */\r\n\treadonly authority:string | null;\r\n\r\n\t/**\r\n\t * Gets the path and Query properties separated by a question mark (?).\r\n\t */\r\n\treadonly pathAndQuery:string | null;\r\n\r\n\t/**\r\n\t * Gets the full path without the query or fragment.\r\n\t */\r\n\treadonly baseUri:string;\r\n\r\n\t/**\r\n\t * The segments that represent a path.<br/>\r\n\t * https://msdn.microsoft.com/en-us/library/system.uri.segments%28v=vs.110%29.aspx\r\n\t *\r\n\t * <h5><b>Example:</b></h5>\r\n\t * If the path value equals: ```/tree/node/index.html```<br/>\r\n\t * The result will be: ```['/','tree/','node/','index.html']```\r\n\t * @returns {string[]}\r\n\t */\r\n\tget pathSegments():string[]\r\n\t{\r\n\t\treturn this.path\r\n\t\t\t&& this.path.match(/^[/]|[^/]*[/]|[^/]+$/g)\r\n\t\t\t|| [];\r\n\t}\r\n\r\n\t/**\r\n\t * Creates a writable copy.\r\n\t * @returns {IUri}\r\n\t */\r\n\ttoMap():IUri\r\n\t{\r\n\t\treturn this.copyTo({});\r\n\t}\r\n\r\n\t/**\r\n\t * @returns {string} The full absolute uri.\r\n\t */\r\n\ttoString():string\r\n\t{\r\n\t\treturn this.absoluteUri;\r\n\t}\r\n\r\n\t/**\r\n\t * Properly converts an existing URI to a string.\r\n\t * @param uri\r\n\t * @returns {string}\r\n\t */\r\n\tstatic toString(uri:IUri):string\r\n\t{\r\n\t\treturn uri instanceof <any>Uri\r\n\t\t\t? (<Uri>uri).absoluteUri\r\n\t\t\t: uriToString(uri);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the authority segment of an URI.\r\n\t * @param uri\r\n\t * @returns {string}\r\n\t */\r\n\tstatic getAuthority(uri:IUri):string\r\n\t{\r\n\t\treturn getAuthority(uri);\r\n\t}\r\n\r\n\r\n}\r\n\r\nexport enum Fields {\r\n\tscheme,\r\n\tuserInfo,\r\n\thost,\r\n\tport,\r\n\tpath,\r\n\tquery,\r\n\tfragment\r\n}\r\nObject.freeze(Fields);\r\n\r\nfunction copyUri(from:IUri, to?:IUri)\r\n{\r\n\tlet i = 0, field:string;\r\n\tif(!to) to = {};\r\n\twhile(field = Fields[i++])\r\n\t{\r\n\t\tconst value = (<any>from)[field];\r\n\t\tif(value) (<any>to)[field] = value;\r\n\t}\r\n\treturn to;\r\n}\r\n\r\nconst SLASH = '/', SLASH2 = '//', QM = Separator.Query, HASH = '#', EMPTY = '', AT = '@';\r\n\r\nfunction getScheme(scheme:SchemeValue.Any|string|null|undefined):SchemeValue.Any|null\r\n{\r\n\tlet s:any = scheme;\r\n\tif(Type.isString(s))\r\n\t{\r\n\t\tif(!s) return null;\r\n\t\ts = trim(s)\r\n\t\t\t.toLowerCase()\r\n\t\t\t.replace(/[^a-z0-9+.-]+$/g, EMPTY);\r\n\t\tif(!s) return null;\r\n\t\tif(Scheme.isValid(s)) return s;\r\n\t}\r\n\telse\r\n\t{\r\n\t\tif(s==null) return s;\r\n\t}\r\n\tthrow new ArgumentOutOfRangeException('scheme', scheme, 'Invalid scheme.');\r\n}\r\n\r\nfunction getPort(port:number|string|null|undefined):number|null\r\n{\r\n\tif(port===0) return <number>port;\r\n\tif(!port) return null;\r\n\tlet p:number;\r\n\r\n\tif(Type.isNumber(port))\r\n\t{\r\n\t\tp = <number>port;\r\n\t\tif(p>=0 && isFinite(p))\r\n\t\t\treturn p;\r\n\t}\r\n\telse if(Type.isString(port) && (p = parseInt(<string>port)) && !isNaN(p))\r\n\t{\r\n\t\treturn getPort(p);\r\n\t}\r\n\r\n\tthrow new ArgumentException(\"port\", \"invalid value\");\r\n}\r\n\r\nfunction getAuthority(uri:IUri):string\r\n{\r\n\r\n\tif(!uri.host)\r\n\t{\r\n\t\tif(uri.userInfo)\r\n\t\t\tthrow new ArgumentException('host', 'Cannot include user info when there is no host.');\r\n\r\n\t\tif(Type.isNumber(uri.port, true))\r\n\t\t\tthrow new ArgumentException('host', 'Cannot include a port when there is no host.');\r\n\t}\r\n\r\n\t/*\r\n\t * [//[user:password@]host[:port]]\r\n\t */\r\n\r\n\tlet result = uri.host || EMPTY;\r\n\r\n\tif(result)\r\n\t{\r\n\t\tif(uri.userInfo) result = uri.userInfo + AT + result;\r\n\t\tif(!isNaN(<any>(uri.port))) result += ':' + uri.port;\r\n\t\tresult = SLASH2 + result;\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\nfunction formatQuery(query:string|null|undefined):string|null|undefined\r\n{\r\n\treturn query && ((query.indexOf(QM)!==0 ? QM : EMPTY) + query);\r\n}\r\n\r\nfunction formatFragment(fragment:string|null|undefined):string|null|undefined\r\n{\r\n\treturn fragment && ((fragment.indexOf(HASH)!==0 ? HASH : EMPTY) + fragment);\r\n}\r\n\r\nfunction getPathAndQuery(uri:IUri):string\r\n{\r\n\r\n\tconst path  = uri.path,\r\n\t      query = uri.query;\r\n\r\n\treturn EMPTY\r\n\t\t+ (path || EMPTY)\r\n\t\t+ (formatQuery(query) || EMPTY);\r\n\r\n}\r\n\r\nfunction uriToString(uri:IUri):string\r\n{\r\n\t// scheme:[//[user:password@]domain[:port]][/]path[?query][#fragment]\r\n\t// {scheme}{authority}{path}{query}{fragment}\r\n\r\n\tconst scheme = getScheme(uri.scheme);\r\n\tlet authority = getAuthority(uri);\r\n\tconst pathAndQuery = getPathAndQuery(uri),\r\n\t      fragment     = formatFragment(uri.fragment);\r\n\r\n\tconst part1 = EMPTY\r\n\t\t+ ((scheme && (scheme + ':')) || EMPTY)\r\n\t\t+ (authority || EMPTY);\r\n\r\n\tlet part2 = EMPTY\r\n\t\t+ (pathAndQuery || EMPTY)\r\n\t\t+ (fragment || EMPTY);\r\n\r\n\tif(part1 && part2 && scheme && !authority)\r\n\t\tthrow new ArgumentException('authority', \"Cannot format schemed Uri with missing authority.\");\r\n\r\n\tif(part1 && pathAndQuery && pathAndQuery.indexOf(SLASH)!==0)\r\n\t\tpart2 = SLASH + part2;\r\n\r\n\treturn part1 + part2;\r\n\r\n}\r\n\r\n\r\nfunction tryParse(url:string, out:Action<IUri>):null|Exception\r\n{\r\n\tif(!url)\r\n\t\treturn new ArgumentException('url', 'Nothing to parse.');\r\n\r\n\r\n\t// Could use a regex here, but well follow some rules instead.\r\n\t// The intention is to 'gather' the pieces.  This isn't validation (yet).\r\n\r\n\t// scheme:[//[user:password@]domain[:port]][/]path[?query][#fragment]\r\n\tlet i:number;\r\n\tconst result:IUri = {};\r\n\r\n\t// Anything after the first # is the fragment.\r\n\ti = url.indexOf(HASH);\r\n\tif(i!= -1)\r\n\t{\r\n\t\tresult.fragment = url.substring(i + 1) || VOID0;\r\n\t\turl = url.substring(0, i);\r\n\t}\r\n\r\n\t// Anything after the first ? is the query.\r\n\ti = url.indexOf(QM);\r\n\tif(i!= -1)\r\n\t{\r\n\t\tresult.query = url.substring(i + 1) || VOID0;\r\n\t\turl = url.substring(0, i);\r\n\t}\r\n\r\n\t// Guarantees a separation.\r\n\ti = url.indexOf(SLASH2);\r\n\tif(i!= -1)\r\n\t{\r\n\t\tlet scheme = trim(url.substring(0, i));\r\n\t\tconst c = /:$/;\r\n\t\tif(!c.test(scheme))\r\n\t\t\treturn new ArgumentException('url', 'Scheme was improperly formatted');\r\n\r\n\t\tscheme = trim(scheme.replace(c, EMPTY));\r\n\t\ttry\r\n\t\t{\r\n\t\t\tresult.scheme = getScheme(scheme) || VOID0;\r\n\t\t}\r\n\t\tcatch(ex)\r\n\t\t{\r\n\t\t\treturn ex;\r\n\t\t}\r\n\r\n\t\turl = url.substring(i + 2);\r\n\t}\r\n\r\n\t// Find any path information.\r\n\ti = url.indexOf(SLASH);\r\n\tif(i!= -1)\r\n\t{\r\n\t\tresult.path = url.substring(i);\r\n\t\turl = url.substring(0, i);\r\n\t}\r\n\r\n\t// Separate user info.\r\n\ti = url.indexOf(AT);\r\n\tif(i!= -1)\r\n\t{\r\n\t\tresult.userInfo = url.substring(0, i) || VOID0;\r\n\t\turl = url.substring(i + 1);\r\n\t}\r\n\r\n\t// Remaining is host and port.\r\n\ti = url.indexOf(':');\r\n\tif(i!= -1)\r\n\t{\r\n\t\tconst port = parseInt(trim(url.substring(i + 1)));\r\n\t\tif(isNaN(port))\r\n\t\t\treturn new ArgumentException('url', 'Port was invalid.');\r\n\r\n\t\tresult.port = port;\r\n\t\turl = url.substring(0, i);\r\n\t}\r\n\r\n\turl = trim(url);\r\n\tif(url)\r\n\t\tresult.host = url;\r\n\r\n\tout(copyUri(result));\r\n\r\n\t// null is good! (here)\r\n\treturn null;\r\n\r\n}\r\n\r\nexport default Uri;"]}